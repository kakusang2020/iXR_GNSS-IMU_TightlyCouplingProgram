function STD=Neill_Map(ZHD,ZWD,Ele,B,H,DOY)

%Calculate the Slant Total Delay of tropsphere by using Neill Mapping
%Function

%Inputs:
%  ZHD  Zenith Hydro Delay(m)
%  ZWD  Zenith Wet Delay(m)
%  Ele  Satllite elevation(degree)
%  B    Latitude(degree)
%  H    Height(m)
%  DOY  Day of year

%Output:
%  STD  Slant Total Delay(m)

% Written by: Zhang Yize

if B>0
    doymin=28;  %Annual product day of minimum value
else
    doymin=211;
end

k=cos(2*pi*(DOY-doymin)/365.25);
B=abs(B);
if abs(B)<15
    ah=1.2769934e-3-0.0*k;
    bh=2.9153695e-3-0.0*k;
    ch=62.610505e-3-0.0*k;
    aw=5.8021897e-4;
    bw=1.4275268e-3;
    cw=4.3472961e-2;
elseif abs(B)<30
    m=(B-15)/15;
    ah=1.2769934e-3+m*(1.2683230-1.2769934)*1e-3-(0.0+m*(1.2709626-0.0))*1e-5*k;
    bh=2.9153695e-3+m*(2.9152299-2.9153695)*1e-3-(0.0+m*(2.1414979-0.0))*1e-5*k;
    ch=62.610505e-3+m*(62.837393-62.610505)*1e-3-(0.0+m*(9.012840-0.0))*1e-5*k;
    aw=5.8021897e-4+m*(5.6794847-5.8021897)*1e-4;
    bw=1.4275268e-3+m*(1.5138625-1.4275268)*1e-3;
    cw=4.3472961e-2+m*(4.6729510-4.3472961)*1e-2;
elseif abs(B)<45
    m=(B-30)/15;
    ah=1.2683230e-3+m*(1.2465397-1.2683230)*1e-3-(1.2709626+m*(2.65236662-1.2709626))*1e-5*k;
    bh=2.9152299e-3+m*(2.9288445-2.9152299)*1e-3-(2.1414979+m*(3.0160779-2.1414979))*1e-5*k;
    ch=62.837393e-3+m*(63.721774-62.837393)*1e-3-(9.012840+m*(4.349703-9.012840))*1e-5*k;
    aw=5.6794847e-4+m*(5.8118019-5.6794847)*1e-4;
    bw=1.5138625e-3+m*(1.4572752-1.5138625)*1e-3;
    cw=4.6729510e-2+m*(4.3908931-4.6729510)*1e-2;
elseif abs(B)<60
    m=(B-45)/15;
    ah=1.2465397e-3+m*(1.2196049-1.2465397)*1e-3-(2.65236662+m*(3.4000452-2.65236662))*1e-5*k;
    bh=2.9288445e-3+m*(2.9022565-2.9288445)*1e-3-(3.0160779+m*(7.2562722-3.0160779))*1e-5*k;
    ch=63.721774e-3+m*(63.824265-63.721774)*1e-3-(4.349703+m*(84.795348-4.349703))*1e-5*k;
    aw=5.8118019e-4+m*(5.9727542-5.8118019)*1e-4;
    bw=1.4572752e-3+m*(1.5007428-1.4572752)*1e-3;
    cw=4.3908931e-2+m*(4.4626982-4.3908931)*1e-2;
elseif abs(B)<75
    m=(B-60)/15;
    ah=1.2196049e-3+m*(1.2045996-1.2196049)*1e-3-(3.4000452+m*(4.1202191-3.4000452))*1e-5*k;
    bh=2.9022565e-3+m*(2.9024912-2.9022565)*1e-3-(7.2562722+m*(11.723375-7.2562722))*1e-5*k;
    ch=63.824265e-3+m*(64.258455-63.824265)*1e-3-(84.795348+m*(170.37206-84.795348))*1e-5*k;
    aw=5.9727542e-4+m*(6.1641693-5.9727542)*1e-4;
    bw=1.5007428e-3+m*(1.7599082-1.5007428)*1e-3;
    cw=4.4626982e-2+m*(5.4736038-4.4626982)*1e-2;
else
    ah=1.2045996e-3-4.1202191e-5*k;
    bh=2.9024912e-3-11.723375e-5*k;
    ch=64.258455e-3-170.37206e-5*k;
    aw=6.1641693e-4;
    bw=1.7599082e-3;
    cw=5.4736038e-2;
end

aht=2.53e-5;bht=5.49e-3;cht=1.14e-3;
%Mapping function of dry delay and wet delay
MFh=(1+(ah/(1+bh/(1+ch))))/(sind(Ele)+(ah/(sind(Ele)+bh/(sind(Ele)+ch))))+...
    (1/sind(Ele)-(1+(aht/(1+bht/(1+cht))))/(sind(Ele)+(aht/(sind(Ele)+bht/(sind(Ele)+cht)))))*H/1000;
MFw=(1+(aw/(1+bw/(1+cw))))/(sind(Ele)+(aw/(sind(Ele)+bw/(sind(Ele)+cw))));

STD=ZHD*MFh+ZWD*MFw;  %Total delay on ramp

end